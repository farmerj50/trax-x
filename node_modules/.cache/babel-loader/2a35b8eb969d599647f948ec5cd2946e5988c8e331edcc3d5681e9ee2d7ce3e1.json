{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n  return target;\n};\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\nvar _react = require(\"react\");\nvar _react2 = _interopRequireDefault(_react);\nvar _propTypes = require(\"prop-types\");\nvar _propTypes2 = _interopRequireDefault(_propTypes);\nvar _d3Array = require(\"d3-array\");\nvar _d3Collection = require(\"d3-collection\");\nvar _d3Scale = require(\"d3-scale\");\nvar _GenericChartComponent = require(\"../GenericChartComponent\");\nvar _GenericChartComponent2 = _interopRequireDefault(_GenericChartComponent);\nvar _GenericComponent = require(\"../GenericComponent\");\nvar _utils = require(\"../utils\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\nvar VolumeProfileSeries = function (_Component) {\n  _inherits(VolumeProfileSeries, _Component);\n  function VolumeProfileSeries(props) {\n    _classCallCheck(this, VolumeProfileSeries);\n    var _this = _possibleConstructorReturn(this, (VolumeProfileSeries.__proto__ || Object.getPrototypeOf(VolumeProfileSeries)).call(this, props));\n    _this.renderSVG = _this.renderSVG.bind(_this);\n    _this.drawOnCanvas = _this.drawOnCanvas.bind(_this);\n    return _this;\n  }\n  _createClass(VolumeProfileSeries, [{\n    key: \"drawOnCanvas\",\n    value: function drawOnCanvas(ctx, moreProps) {\n      var xAccessor = moreProps.xAccessor,\n        width = moreProps.width;\n      var _helper = helper(this.props, moreProps, xAccessor, width),\n        rects = _helper.rects,\n        sessionBg = _helper.sessionBg;\n      _drawOnCanvas(ctx, this.props, rects, sessionBg);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return _react2.default.createElement(_GenericChartComponent2.default, {\n        svgDraw: this.renderSVG,\n        canvasDraw: this.drawOnCanvas,\n        canvasToDraw: _GenericComponent.getAxisCanvas,\n        drawOn: [\"pan\"]\n      });\n    }\n  }, {\n    key: \"renderSVG\",\n    value: function renderSVG(moreProps) {\n      var _props = this.props,\n        className = _props.className,\n        opacity = _props.opacity;\n      var _props2 = this.props,\n        showSessionBackground = _props2.showSessionBackground,\n        sessionBackGround = _props2.sessionBackGround,\n        sessionBackGroundOpacity = _props2.sessionBackGroundOpacity;\n      var xAccessor = moreProps.xAccessor,\n        width = moreProps.width;\n      var _helper2 = helper(this.props, moreProps, xAccessor, width),\n        rects = _helper2.rects,\n        sessionBg = _helper2.sessionBg;\n      var sessionBgSvg = showSessionBackground ? sessionBg.map(function (d, idx) {\n        return _react2.default.createElement(\"rect\", _extends({\n          key: idx\n        }, d, {\n          opacity: sessionBackGroundOpacity,\n          fill: sessionBackGround\n        }));\n      }) : null;\n      return _react2.default.createElement(\"g\", {\n        className: className\n      }, sessionBgSvg, rects.map(function (d, i) {\n        return _react2.default.createElement(\"g\", {\n          key: i\n        }, _react2.default.createElement(\"rect\", {\n          x: d.x,\n          y: d.y,\n          width: d.w1,\n          height: d.height,\n          fill: d.fill1,\n          stroke: d.stroke1,\n          fillOpacity: opacity\n        }), _react2.default.createElement(\"rect\", {\n          x: d.x + d.w1,\n          y: d.y,\n          width: d.w2,\n          height: d.height,\n          fill: d.fill2,\n          stroke: d.stroke2,\n          fillOpacity: opacity\n        }));\n      }));\n    }\n  }]);\n  return VolumeProfileSeries;\n}(_react.Component);\nVolumeProfileSeries.propTypes = {\n  className: _propTypes2.default.string,\n  opacity: _propTypes2.default.number,\n  showSessionBackground: _propTypes2.default.bool,\n  sessionBackGround: _propTypes2.default.string,\n  sessionBackGroundOpacity: _propTypes2.default.number\n};\nVolumeProfileSeries.defaultProps = {\n  className: \"line \",\n  bins: 20,\n  opacity: 0.5,\n  maxProfileWidthPercent: 50,\n  fill: function fill(_ref) {\n    var type = _ref.type;\n    return type === \"up\" ? \"#6BA583\" : \"#FF0000\";\n  },\n  stroke: \"#FFFFFF\",\n  showSessionBackground: false,\n  sessionBackGround: \"#4682B4\",\n  sessionBackGroundOpacity: 0.3,\n  source: function source(d) {\n    return d.close;\n  },\n  volume: function volume(d) {\n    return d.volume;\n  },\n  absoluteChange: function absoluteChange(d) {\n    return d.absoluteChange;\n  },\n  bySession: false,\n  /* eslint-disable no-unused-vars */\n  sessionStart: function sessionStart(_ref2) {\n    var d = _ref2.d,\n      i = _ref2.i,\n      plotData = _ref2.plotData;\n    return i > 0 && plotData[i - 1].date.getMonth() !== d.date.getMonth();\n  },\n  /* eslint-enable no-unused-vars */\n  orient: \"left\",\n  // // fill: ({ type }) => { var c = type === \"up\" ? \"#6BA583\" : \"#FF0000\"; console.log(type, c); return c },\n  // stroke: ({ type }) =>  type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n  // stroke: \"none\",\n  partialStartOK: true,\n  partialEndOK: true\n};\nfunction helper(props, moreProps, xAccessor, width) {\n  var realXScale = moreProps.xScale,\n    yScale = moreProps.chartConfig.yScale,\n    plotData = moreProps.plotData;\n  var sessionStart = props.sessionStart,\n    bySession = props.bySession,\n    partialStartOK = props.partialStartOK,\n    partialEndOK = props.partialEndOK;\n  var bins = props.bins,\n    maxProfileWidthPercent = props.maxProfileWidthPercent,\n    source = props.source,\n    volume = props.volume,\n    absoluteChange = props.absoluteChange,\n    orient = props.orient,\n    fill = props.fill,\n    stroke = props.stroke;\n  var sessionBuilder = (0, _utils.accumulatingWindow)().discardTillStart(!partialStartOK).discardTillEnd(!partialEndOK).accumulateTill(function (d, i) {\n    return sessionStart(_extends({\n      d: d,\n      i: i\n    }, moreProps));\n  }).accumulator(_utils.identity);\n  var dx = plotData.length > 1 ? realXScale(xAccessor(plotData[1])) - realXScale(xAccessor((0, _utils.head)(plotData))) : 0;\n  var sessions = bySession ? sessionBuilder(plotData) : [plotData];\n  var allRects = sessions.map(function (session) {\n    var begin = bySession ? realXScale(xAccessor((0, _utils.head)(session))) : 0;\n    var finish = bySession ? realXScale(xAccessor((0, _utils.last)(session))) : width;\n    var sessionWidth = finish - begin + dx;\n\n    // console.log(session)\n\n    /* var histogram = d3.layout.histogram()\n    \t\t.value(source)\n    \t\t.bins(bins);*/\n\n    var histogram2 = (0, _d3Array.histogram)()\n    // .domain(xScale.domain())\n    .value(source).thresholds(bins);\n\n    // console.log(bins, histogram(session))\n    // console.log(bins, histogram2(session))\n    var rollup = (0, _d3Collection.nest)().key(function (d) {\n      return d.direction;\n    }).sortKeys(orient === \"right\" ? _d3Array.descending : _d3Array.ascending).rollup(function (leaves) {\n      return (0, _d3Array.sum)(leaves, function (d) {\n        return d.volume;\n      });\n    });\n    var values = histogram2(session);\n    // console.log(\"values\", values)\n\n    var volumeInBins = values.map(function (arr) {\n      return arr.map(function (d) {\n        return absoluteChange(d) > 0 ? {\n          direction: \"up\",\n          volume: volume(d)\n        } : {\n          direction: \"down\",\n          volume: volume(d)\n        };\n      });\n    }).map(function (arr) {\n      return rollup.entries(arr);\n    });\n\n    // console.log(\"volumeInBins\", volumeInBins)\n    var volumeValues = volumeInBins.map(function (each) {\n      return (0, _d3Array.sum)(each.map(function (d) {\n        return d.value;\n      }));\n    });\n\n    // console.log(\"volumeValues\", volumeValues)\n    var base = function base(xScale) {\n      return (0, _utils.head)(xScale.range());\n    };\n    var _ref3 = orient === \"right\" ? [begin, begin + sessionWidth * maxProfileWidthPercent / 100] : [finish, finish - sessionWidth * (100 - maxProfileWidthPercent) / 100],\n      _ref4 = _slicedToArray(_ref3, 2),\n      start = _ref4[0],\n      end = _ref4[1];\n    var xScale = (0, _d3Scale.scaleLinear)().domain([0, (0, _d3Array.max)(volumeValues)]).range([start, end]);\n\n    // console.log(xScale.domain())\n\n    var totalVolumes = volumeInBins.map(function (volumes) {\n      var totalVolume = (0, _d3Array.sum)(volumes, function (d) {\n        return d.value;\n      });\n      var totalVolumeX = xScale(totalVolume);\n      var width = base(xScale) - totalVolumeX;\n      var x = width < 0 ? totalVolumeX + width : totalVolumeX;\n      var ws = volumes.map(function (d) {\n        return {\n          type: d.key,\n          width: d.value * Math.abs(width) / totalVolume\n        };\n      });\n      return {\n        x: x,\n        ws: ws,\n        totalVolumeX: totalVolumeX\n      };\n    });\n    // console.log(\"totalVolumes\", totalVolumes)\n\n    var rects = (0, _d3Array.zip)(values, totalVolumes).map(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n        d = _ref6[0],\n        _ref6$ = _ref6[1],\n        x = _ref6$.x,\n        ws = _ref6$.ws;\n      var w1 = ws[0] || {\n        type: \"up\",\n        width: 0\n      };\n      var w2 = ws[1] || {\n        type: \"down\",\n        width: 0\n      };\n      return {\n        // y: yScale(d.x + d.dx),\n        y: yScale(d.x1),\n        // height: yScale(d.x - d.dx) - yScale(d.x),\n        height: yScale(d.x1) - yScale(d.x0),\n        x: x,\n        width: width,\n        w1: w1.width,\n        w2: w2.width,\n        stroke1: (0, _utils.functor)(stroke)(w1),\n        stroke2: (0, _utils.functor)(stroke)(w2),\n        fill1: (0, _utils.functor)(fill)(w1),\n        fill2: (0, _utils.functor)(fill)(w2)\n      };\n    });\n\n    // console.log(\"rects\", rects)\n\n    var sessionBg = {\n      x: begin,\n      y: (0, _utils.last)(rects).y,\n      height: (0, _utils.head)(rects).y - (0, _utils.last)(rects).y + (0, _utils.head)(rects).height,\n      width: sessionWidth\n    };\n    return {\n      rects: rects,\n      sessionBg: sessionBg\n    };\n  });\n  return {\n    rects: (0, _d3Array.merge)(allRects.map(function (d) {\n      return d.rects;\n    })),\n    sessionBg: allRects.map(function (d) {\n      return d.sessionBg;\n    })\n  };\n}\nfunction _drawOnCanvas(ctx, props, rects, sessionBg) {\n  var opacity = props.opacity,\n    sessionBackGround = props.sessionBackGround,\n    sessionBackGroundOpacity = props.sessionBackGroundOpacity,\n    showSessionBackground = props.showSessionBackground;\n\n  // var { rects, sessionBg } = helper(props, xScale, yScale, plotData);\n\n  if (showSessionBackground) {\n    ctx.fillStyle = (0, _utils.hexToRGBA)(sessionBackGround, sessionBackGroundOpacity);\n    sessionBg.forEach(function (each) {\n      var x = each.x,\n        y = each.y,\n        height = each.height,\n        width = each.width;\n      ctx.beginPath();\n      ctx.rect(x, y, width, height);\n      ctx.closePath();\n      ctx.fill();\n    });\n  }\n  rects.forEach(function (each) {\n    var x = each.x,\n      y = each.y,\n      height = each.height,\n      w1 = each.w1,\n      w2 = each.w2,\n      stroke1 = each.stroke1,\n      stroke2 = each.stroke2,\n      fill1 = each.fill1,\n      fill2 = each.fill2;\n    if (w1 > 0) {\n      ctx.fillStyle = (0, _utils.hexToRGBA)(fill1, opacity);\n      if (stroke1 !== \"none\") ctx.strokeStyle = stroke1;\n      ctx.beginPath();\n      ctx.rect(x, y, w1, height);\n      ctx.closePath();\n      ctx.fill();\n      if (stroke1 !== \"none\") ctx.stroke();\n    }\n    if (w2 > 0) {\n      ctx.fillStyle = (0, _utils.hexToRGBA)(fill2, opacity);\n      if (stroke2 !== \"none\") ctx.strokeStyle = stroke2;\n      ctx.beginPath();\n      ctx.rect(x + w1, y, w2, height);\n      ctx.closePath();\n      ctx.fill();\n      if (stroke2 !== \"none\") ctx.stroke();\n    }\n  });\n}\nexports.default = VolumeProfileSeries;","map":{"version":3,"names":["_react","require","_propTypes","_d3Array","_d3Collection","_d3Scale","_GenericChartComponent","_GenericComponent","_utils","VolumeProfileSeries","props","_classCallCheck","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","renderSVG","bind","drawOnCanvas","ctx","moreProps","xAccessor","width","_helper","helper","rects","sessionBg","_drawOnCanvas","_react2","default","createElement","_GenericChartComponent2","svgDraw","canvasDraw","canvasToDraw","getAxisCanvas","drawOn","_props","className","opacity","_props2","showSessionBackground","sessionBackGround","sessionBackGroundOpacity","_helper2","sessionBgSvg","map","d","idx","_extends","key","fill","i","x","y","w1","height","fill1","stroke","stroke1","fillOpacity","w2","fill2","stroke2","propTypes","_propTypes2","string","number","bool","defaultProps","bins","maxProfileWidthPercent","_ref","type","source","close","volume","absoluteChange","bySession","sessionStart","_ref2","plotData","date","getMonth","orient","partialStartOK","partialEndOK","realXScale","xScale","yScale","chartConfig","sessionBuilder","accumulatingWindow","discardTillStart","discardTillEnd","accumulateTill","accumulator","identity","dx","length","head","sessions","allRects","session","begin","finish","last","sessionWidth","histogram2","histogram","value","thresholds","rollup","nest","direction","sortKeys","descending","ascending","leaves","sum","values","volumeInBins","arr","entries","volumeValues","each","base","range","_ref3","_ref4","_slicedToArray","start","end","scaleLinear","domain","max","totalVolumes","volumes","totalVolume","totalVolumeX","ws","Math","abs","zip","_ref5","_ref6","_ref6$","x1","x0","functor","merge","fillStyle","hexToRGBA","forEach","beginPath","rect","closePath","strokeStyle"],"sources":["C:\\Users\\gabby\\trax-x\\node_modules\\src\\lib\\series\\VolumeProfileSeries.js"],"sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { ascending, descending, sum, max, merge, zip, histogram as d3Histogram } from \"d3-array\";\nimport { nest } from \"d3-collection\";\nimport { scaleLinear } from \"d3-scale\";\n\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas } from \"../GenericComponent\";\n\nimport { head, last, hexToRGBA, accumulatingWindow, identity, functor } from \"../utils\";\n\nclass VolumeProfileSeries extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { xAccessor, width } = moreProps;\n\t\tconst { rects, sessionBg } = helper(this.props, moreProps, xAccessor, width);\n\n\t\tdrawOnCanvas(ctx, this.props, rects, sessionBg);\n\t}\n\trender() {\n\t\treturn <GenericChartComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getAxisCanvas}\n\t\t\tdrawOn={[\"pan\"]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { className, opacity } = this.props;\n\t\tconst { showSessionBackground, sessionBackGround, sessionBackGroundOpacity } = this.props;\n\n\t\tconst { xAccessor, width } = moreProps;\n\t\tconst { rects, sessionBg } = helper(this.props, moreProps, xAccessor, width);\n\n\t\tconst sessionBgSvg = showSessionBackground\n\t\t\t? sessionBg.map((d, idx) => <rect key={idx} {...d} opacity={sessionBackGroundOpacity} fill={sessionBackGround} />)\n\t\t\t: null;\n\n\t\treturn <g className={className}>\n\t\t\t{sessionBgSvg}\n\t\t\t{rects.map((d, i) => <g key={i}>\n\t\t\t\t<rect x={d.x} y={d.y}\n\t\t\t\t\twidth={d.w1} height={d.height}\n\t\t\t\t\tfill={d.fill1} stroke={d.stroke1} fillOpacity={opacity} />\n\t\t\t\t<rect x={d.x + d.w1} y={d.y}\n\t\t\t\t\twidth={d.w2} height={d.height}\n\t\t\t\t\tfill={d.fill2} stroke={d.stroke2} fillOpacity={opacity} />\n\t\t\t</g>)}\n\t\t</g>;\n\t}\n}\n\nVolumeProfileSeries.propTypes = {\n\tclassName: PropTypes.string,\n\topacity: PropTypes.number,\n\tshowSessionBackground: PropTypes.bool,\n\tsessionBackGround: PropTypes.string,\n\tsessionBackGroundOpacity: PropTypes.number,\n};\n\n\nVolumeProfileSeries.defaultProps = {\n\tclassName: \"line \",\n\tbins: 20,\n\topacity: 0.5,\n\tmaxProfileWidthPercent: 50,\n\tfill: ({ type }) => type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n\tstroke: \"#FFFFFF\",\n\tshowSessionBackground: false,\n\tsessionBackGround: \"#4682B4\",\n\tsessionBackGroundOpacity: 0.3,\n\n\tsource: d => d.close,\n\tvolume: d => d.volume,\n\tabsoluteChange: d => d.absoluteChange,\n\tbySession: false,\n\t/* eslint-disable no-unused-vars */\n\tsessionStart: ({ d, i, plotData }) => i > 0 && plotData[i - 1].date.getMonth() !== d.date.getMonth(),\n\t/* eslint-enable no-unused-vars */\n\torient: \"left\",\n\t// // fill: ({ type }) => { var c = type === \"up\" ? \"#6BA583\" : \"#FF0000\"; console.log(type, c); return c },\n\t// stroke: ({ type }) =>  type === \"up\" ? \"#6BA583\" : \"#FF0000\",\n\t// stroke: \"none\",\n\tpartialStartOK: true,\n\tpartialEndOK: true,\n};\n\nfunction helper(props, moreProps, xAccessor, width) {\n\tconst { xScale: realXScale, chartConfig: { yScale }, plotData } = moreProps;\n\n\tconst { sessionStart, bySession, partialStartOK, partialEndOK } = props;\n\tconst { bins, maxProfileWidthPercent, source, volume, absoluteChange, orient, fill, stroke } = props;\n\n\tconst sessionBuilder = accumulatingWindow()\n\t\t.discardTillStart(!partialStartOK)\n\t\t.discardTillEnd(!partialEndOK)\n\t\t.accumulateTill((d, i) => {\n\t\t\treturn sessionStart({ d, i, ...moreProps });\n\t\t})\n\t\t.accumulator(identity);\n\n\tconst dx = plotData.length > 1 ? realXScale(xAccessor(plotData[1])) - realXScale(xAccessor(head(plotData))) : 0;\n\n\tconst sessions = bySession ? sessionBuilder(plotData) : [plotData];\n\n\tconst allRects = sessions.map(session => {\n\n\t\tconst begin = bySession ? realXScale(xAccessor(head(session))) : 0;\n\t\tconst finish = bySession ? realXScale(xAccessor(last(session))) : width;\n\t\tconst sessionWidth = finish - begin + dx;\n\n\t\t// console.log(session)\n\n\t\t/* var histogram = d3.layout.histogram()\n\t\t\t\t.value(source)\n\t\t\t\t.bins(bins);*/\n\n\t\tconst histogram2 = d3Histogram()\n\t\t\t// .domain(xScale.domain())\n\t\t\t.value(source)\n\t\t\t.thresholds(bins);\n\n\t\t// console.log(bins, histogram(session))\n\t\t// console.log(bins, histogram2(session))\n\t\tconst rollup = nest()\n\t\t\t.key(d => d.direction)\n\t\t\t.sortKeys(orient === \"right\" ? descending : ascending)\n\t\t\t.rollup(leaves => sum(leaves, d => d.volume));\n\n\t\tconst values = histogram2(session);\n\t\t// console.log(\"values\", values)\n\n\t\tconst volumeInBins = values\n\t\t\t.map(arr => arr.map(d => absoluteChange(d) > 0 ? { direction: \"up\", volume: volume(d) } : { direction: \"down\", volume: volume(d) }))\n\t\t\t.map(arr => rollup.entries(arr));\n\n\t\t// console.log(\"volumeInBins\", volumeInBins)\n\t\tconst volumeValues = volumeInBins\n\t\t\t.map(each => sum(each.map(d => d.value)));\n\n\t\t// console.log(\"volumeValues\", volumeValues)\n\t\tconst base = xScale => head(xScale.range());\n\n\t\tconst [start, end] = orient === \"right\"\n\t\t\t? [begin, begin + sessionWidth * maxProfileWidthPercent / 100]\n\t\t\t: [finish, finish - sessionWidth * (100 - maxProfileWidthPercent) / 100];\n\n\t\tconst xScale = scaleLinear()\n\t\t\t.domain([0, max(volumeValues)])\n\t\t\t.range([start, end]);\n\n\t\t// console.log(xScale.domain())\n\n\t\tconst totalVolumes = volumeInBins.map(volumes => {\n\n\t\t\tconst totalVolume = sum(volumes, d => d.value);\n\t\t\tconst totalVolumeX = xScale(totalVolume);\n\t\t\tconst width = base(xScale) - totalVolumeX;\n\t\t\tconst x = width < 0 ? totalVolumeX + width : totalVolumeX;\n\n\t\t\tconst ws = volumes.map(d => {\n\t\t\t\treturn {\n\t\t\t\t\ttype: d.key,\n\t\t\t\t\twidth: d.value * Math.abs(width) / totalVolume,\n\t\t\t\t};\n\t\t\t});\n\n\t\t\treturn { x, ws, totalVolumeX };\n\t\t});\n\t\t// console.log(\"totalVolumes\", totalVolumes)\n\n\t\tconst rects = zip(values, totalVolumes)\n\t\t\t.map(([d, { x, ws }]) => {\n\t\t\t\tconst w1 = ws[0] || { type: \"up\", width: 0 };\n\t\t\t\tconst w2 = ws[1] || { type: \"down\", width: 0 };\n\n\t\t\t\treturn {\n\t\t\t\t\t// y: yScale(d.x + d.dx),\n\t\t\t\t\ty: yScale(d.x1),\n\t\t\t\t\t// height: yScale(d.x - d.dx) - yScale(d.x),\n\t\t\t\t\theight: yScale(d.x1) - yScale(d.x0),\n\t\t\t\t\tx,\n\t\t\t\t\twidth,\n\t\t\t\t\tw1: w1.width,\n\t\t\t\t\tw2: w2.width,\n\t\t\t\t\tstroke1: functor(stroke)(w1),\n\t\t\t\t\tstroke2: functor(stroke)(w2),\n\t\t\t\t\tfill1: functor(fill)(w1),\n\t\t\t\t\tfill2: functor(fill)(w2),\n\t\t\t\t};\n\t\t\t});\n\n\t\t// console.log(\"rects\", rects)\n\n\t\tconst sessionBg = {\n\t\t\tx: begin,\n\t\t\ty: last(rects).y,\n\t\t\theight: head(rects).y - last(rects).y + head(rects).height,\n\t\t\twidth: sessionWidth,\n\t\t};\n\n\t\treturn { rects, sessionBg };\n\t});\n\n\treturn {\n\t\trects: merge(allRects.map(d => d.rects)),\n\t\tsessionBg: allRects.map(d => d.sessionBg),\n\t};\n}\n\n\nfunction drawOnCanvas(ctx, props, rects, sessionBg) {\n\tconst { opacity, sessionBackGround, sessionBackGroundOpacity, showSessionBackground } = props;\n\n\t// var { rects, sessionBg } = helper(props, xScale, yScale, plotData);\n\n\tif (showSessionBackground) {\n\t\tctx.fillStyle = hexToRGBA(sessionBackGround, sessionBackGroundOpacity);\n\n\t\tsessionBg.forEach(each => {\n\t\t\tconst { x, y, height, width } = each;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, width, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\t\t});\n\t}\n\n\trects.forEach(each => {\n\t\tconst { x, y, height, w1, w2, stroke1, stroke2, fill1, fill2 } = each;\n\n\n\t\tif (w1 > 0) {\n\t\t\tctx.fillStyle = hexToRGBA(fill1, opacity);\n\t\t\tif (stroke1 !== \"none\") ctx.strokeStyle = stroke1;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x, y, w1, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\n\t\t\tif (stroke1 !== \"none\") ctx.stroke();\n\t\t}\n\n\t\tif (w2 > 0) {\n\t\t\tctx.fillStyle = hexToRGBA(fill2, opacity);\n\t\t\tif (stroke2 !== \"none\") ctx.strokeStyle = stroke2;\n\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(x + w1, y, w2, height);\n\t\t\tctx.closePath();\n\t\t\tctx.fill();\n\n\t\t\tif (stroke2 !== \"none\") ctx.stroke();\n\t\t}\n\n\t});\n}\n\nexport default VolumeProfileSeries;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}