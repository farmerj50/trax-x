{"ast":null,"code":"import { merge, rebind, slidingWindow } from \"../utils\";\nimport baseIndicator from \"./baseIndicator\";\nimport { ElderImpulse as appearanceOptions } from \"./defaultOptionsForAppearance\";\nconst ALGORITHM_TYPE = \"ElderImpulse\";\nexport default function () {\n  let macdSource;\n  let emaSource;\n  const base = baseIndicator().type(ALGORITHM_TYPE).stroke(appearanceOptions.stroke).fill(undefined);\n  const underlyingAlgorithm = slidingWindow().windowSize(2).undefinedValue(\"neutral\").accumulator(([prev, curr]) => {\n    if (macdSource === undefined) {\n      throw new Error(`macdSource not defined for ${ALGORITHM_TYPE} calculator`);\n    }\n    if (emaSource === undefined) {\n      throw new Error(`emaSource not defined for ${ALGORITHM_TYPE} calculator`);\n    }\n    const prevMacd = macdSource(prev);\n    const prevEMA = emaSource(prev);\n    if (prevMacd !== undefined && prevEMA !== undefined) {\n      const prevMACDDivergence = prevMacd.divergence;\n      const currMACDDivergence = macdSource(curr).divergence;\n      const currEMA = emaSource(curr);\n      if (currMACDDivergence >= prevMACDDivergence && currEMA >= prevEMA) {\n        return \"up\";\n      }\n      if (currMACDDivergence <= prevMACDDivergence && currEMA <= prevEMA) {\n        return \"down\";\n      }\n    }\n    return \"neutral\";\n  });\n  const mergedAlgorithm = merge().algorithm(underlyingAlgorithm).merge((datum, i) => {\n    datum.elderImpulse = i;\n  });\n  const indicator = function (data, options = {\n    merge: true\n  }) {\n    const newData = options.merge ? mergedAlgorithm(data) : underlyingAlgorithm(data);\n    return newData;\n  };\n  indicator.macdSource = function (x) {\n    if (!arguments.length) {\n      return macdSource;\n    }\n    macdSource = x;\n    return indicator;\n  };\n  indicator.emaSource = function (x) {\n    if (!arguments.length) {\n      return emaSource;\n    }\n    emaSource = x;\n    return indicator;\n  };\n  rebind(indicator, base, \"id\", \"echo\", \"type\", \"stroke\");\n  rebind(indicator, mergedAlgorithm, \"merge\", \"skipUndefined\");\n  return indicator;\n}","map":{"version":3,"names":["merge","rebind","slidingWindow","baseIndicator","ElderImpulse","appearanceOptions","ALGORITHM_TYPE","macdSource","emaSource","base","type","stroke","fill","undefined","underlyingAlgorithm","windowSize","undefinedValue","accumulator","prev","curr","Error","prevMacd","prevEMA","prevMACDDivergence","divergence","currMACDDivergence","currEMA","mergedAlgorithm","algorithm","datum","i","elderImpulse","indicator","data","options","newData","x","arguments","length"],"sources":["C:\\Users\\gabby\\trax-x\\node_modules\\@react-financial-charts\\indicators\\src\\indicator\\elderImpulse.ts"],"sourcesContent":["import { merge, rebind, slidingWindow } from \"../utils\";\nimport baseIndicator from \"./baseIndicator\";\nimport { ElderImpulse as appearanceOptions } from \"./defaultOptionsForAppearance\";\n\nconst ALGORITHM_TYPE = \"ElderImpulse\";\n\nexport default function () {\n    let macdSource: any | undefined;\n    let emaSource: any | undefined;\n\n    const base = baseIndicator().type(ALGORITHM_TYPE).stroke(appearanceOptions.stroke).fill(undefined);\n\n    const underlyingAlgorithm = slidingWindow()\n        .windowSize(2)\n        .undefinedValue(\"neutral\")\n        .accumulator(([prev, curr]: any) => {\n            if (macdSource === undefined) {\n                throw new Error(`macdSource not defined for ${ALGORITHM_TYPE} calculator`);\n            }\n            if (emaSource === undefined) {\n                throw new Error(`emaSource not defined for ${ALGORITHM_TYPE} calculator`);\n            }\n\n            const prevMacd = macdSource(prev);\n            const prevEMA = emaSource(prev);\n\n            if (prevMacd !== undefined && prevEMA !== undefined) {\n                const prevMACDDivergence = prevMacd.divergence;\n                const currMACDDivergence = macdSource(curr).divergence;\n\n                const currEMA = emaSource(curr);\n\n                if (currMACDDivergence >= prevMACDDivergence && currEMA >= prevEMA) {\n                    return \"up\";\n                }\n\n                if (currMACDDivergence <= prevMACDDivergence && currEMA <= prevEMA) {\n                    return \"down\";\n                }\n            }\n            return \"neutral\";\n        });\n\n    const mergedAlgorithm = merge()\n        .algorithm(underlyingAlgorithm)\n        .merge((datum: any, i: number) => {\n            datum.elderImpulse = i;\n        });\n\n    const indicator = function (data: any, options = { merge: true }) {\n        const newData = options.merge ? mergedAlgorithm(data) : underlyingAlgorithm(data);\n\n        return newData;\n    };\n    indicator.macdSource = function (x: any) {\n        if (!arguments.length) {\n            return macdSource;\n        }\n        macdSource = x;\n        return indicator;\n    };\n    indicator.emaSource = function (x: any) {\n        if (!arguments.length) {\n            return emaSource;\n        }\n        emaSource = x;\n        return indicator;\n    };\n    rebind(indicator, base, \"id\", \"echo\", \"type\", \"stroke\");\n    rebind(indicator, mergedAlgorithm, \"merge\", \"skipUndefined\");\n\n    return indicator;\n}\n"],"mappings":"AAAA,SAASA,KAAK,EAAEC,MAAM,EAAEC,aAAa,QAAQ,UAAU;AACvD,OAAOC,aAAa,MAAM,iBAAiB;AAC3C,SAASC,YAAY,IAAIC,iBAAiB,QAAQ,+BAA+B;AAEjF,MAAMC,cAAc,GAAG,cAAc;AAErC,eAAc;EACV,IAAIC,UAA2B;EAC/B,IAAIC,SAA0B;EAE9B,MAAMC,IAAI,GAAGN,aAAa,EAAE,CAACO,IAAI,CAACJ,cAAc,CAAC,CAACK,MAAM,CAACN,iBAAiB,CAACM,MAAM,CAAC,CAACC,IAAI,CAACC,SAAS,CAAC;EAElG,MAAMC,mBAAmB,GAAGZ,aAAa,EAAE,CACtCa,UAAU,CAAC,CAAC,CAAC,CACbC,cAAc,CAAC,SAAS,CAAC,CACzBC,WAAW,CAAC,CAAC,CAACC,IAAI,EAAEC,IAAI,CAAM,KAAI;IAC/B,IAAIZ,UAAU,KAAKM,SAAS,EAAE;MAC1B,MAAM,IAAIO,KAAK,CAAC,8BAA8Bd,cAAc,aAAa,CAAC;;IAE9E,IAAIE,SAAS,KAAKK,SAAS,EAAE;MACzB,MAAM,IAAIO,KAAK,CAAC,6BAA6Bd,cAAc,aAAa,CAAC;;IAG7E,MAAMe,QAAQ,GAAGd,UAAU,CAACW,IAAI,CAAC;IACjC,MAAMI,OAAO,GAAGd,SAAS,CAACU,IAAI,CAAC;IAE/B,IAAIG,QAAQ,KAAKR,SAAS,IAAIS,OAAO,KAAKT,SAAS,EAAE;MACjD,MAAMU,kBAAkB,GAAGF,QAAQ,CAACG,UAAU;MAC9C,MAAMC,kBAAkB,GAAGlB,UAAU,CAACY,IAAI,CAAC,CAACK,UAAU;MAEtD,MAAME,OAAO,GAAGlB,SAAS,CAACW,IAAI,CAAC;MAE/B,IAAIM,kBAAkB,IAAIF,kBAAkB,IAAIG,OAAO,IAAIJ,OAAO,EAAE;QAChE,OAAO,IAAI;;MAGf,IAAIG,kBAAkB,IAAIF,kBAAkB,IAAIG,OAAO,IAAIJ,OAAO,EAAE;QAChE,OAAO,MAAM;;;IAGrB,OAAO,SAAS;EACpB,CAAC,CAAC;EAEN,MAAMK,eAAe,GAAG3B,KAAK,EAAE,CAC1B4B,SAAS,CAACd,mBAAmB,CAAC,CAC9Bd,KAAK,CAAC,CAAC6B,KAAU,EAAEC,CAAS,KAAI;IAC7BD,KAAK,CAACE,YAAY,GAAGD,CAAC;EAC1B,CAAC,CAAC;EAEN,MAAME,SAAS,GAAG,SAAAA,CAAUC,IAAS,EAAEC,OAAO,GAAG;IAAElC,KAAK,EAAE;EAAI,CAAE;IAC5D,MAAMmC,OAAO,GAAGD,OAAO,CAAClC,KAAK,GAAG2B,eAAe,CAACM,IAAI,CAAC,GAAGnB,mBAAmB,CAACmB,IAAI,CAAC;IAEjF,OAAOE,OAAO;EAClB,CAAC;EACDH,SAAS,CAACzB,UAAU,GAAG,UAAU6B,CAAM;IACnC,IAAI,CAACC,SAAS,CAACC,MAAM,EAAE;MACnB,OAAO/B,UAAU;;IAErBA,UAAU,GAAG6B,CAAC;IACd,OAAOJ,SAAS;EACpB,CAAC;EACDA,SAAS,CAACxB,SAAS,GAAG,UAAU4B,CAAM;IAClC,IAAI,CAACC,SAAS,CAACC,MAAM,EAAE;MACnB,OAAO9B,SAAS;;IAEpBA,SAAS,GAAG4B,CAAC;IACb,OAAOJ,SAAS;EACpB,CAAC;EACD/B,MAAM,CAAC+B,SAAS,EAAEvB,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC;EACvDR,MAAM,CAAC+B,SAAS,EAAEL,eAAe,EAAE,OAAO,EAAE,eAAe,CAAC;EAE5D,OAAOK,SAAS;AACpB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}