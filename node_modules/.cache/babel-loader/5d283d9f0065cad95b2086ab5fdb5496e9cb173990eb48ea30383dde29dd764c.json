{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = function () {\n  var undefinedValue = undefined,\n    windowSize = 10,\n    accumulator = _noop2.default,\n    source = _identity2.default,\n    skipInitial = 0;\n\n  // eslint-disable-next-line prefer-const\n  var mappedSlidingWindow = function mappedSlidingWindow(data) {\n    var size = (0, _index.functor)(windowSize).apply(this, arguments);\n    var windowData = [];\n    var accumulatorIdx = 0;\n    var undef = (0, _index.functor)(undefinedValue);\n    // console.log(skipInitial, size, data.length, windowData.length);\n    var result = [];\n    data.forEach(function (d, i) {\n      // console.log(d, i, windowData.length);\n      var mapped = void 0;\n      if (i < skipInitial + size - 1) {\n        mapped = undef(d, i);\n        result.push(mapped);\n        windowData.push(mapped);\n        return;\n      }\n      if (i >= skipInitial + size) {\n        // Treat windowData as FIFO rolling buffer\n        windowData.shift();\n      }\n      windowData.push(source(d, i));\n      mapped = accumulator(windowData, i, accumulatorIdx++);\n      result.push(mapped);\n      windowData.pop();\n      windowData.push(mapped);\n      return;\n    });\n    return result;\n  };\n  mappedSlidingWindow.undefinedValue = function (x) {\n    if (!arguments.length) {\n      return undefinedValue;\n    }\n    undefinedValue = x;\n    return mappedSlidingWindow;\n  };\n  mappedSlidingWindow.windowSize = function (x) {\n    if (!arguments.length) {\n      return windowSize;\n    }\n    windowSize = x;\n    return mappedSlidingWindow;\n  };\n  mappedSlidingWindow.accumulator = function (x) {\n    if (!arguments.length) {\n      return accumulator;\n    }\n    accumulator = x;\n    return mappedSlidingWindow;\n  };\n  mappedSlidingWindow.skipInitial = function (x) {\n    if (!arguments.length) {\n      return skipInitial;\n    }\n    skipInitial = x;\n    return mappedSlidingWindow;\n  };\n  mappedSlidingWindow.source = function (x) {\n    if (!arguments.length) {\n      return source;\n    }\n    source = x;\n    return mappedSlidingWindow;\n  };\n  return mappedSlidingWindow;\n};\nvar _noop = require(\"./noop\");\nvar _noop2 = _interopRequireDefault(_noop);\nvar _identity = require(\"./identity\");\nvar _identity2 = _interopRequireDefault(_identity);\nvar _index = require(\"./index\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}","map":{"version":3,"names":["undefinedValue","undefined","windowSize","accumulator","_noop2","default","source","_identity2","skipInitial","mappedSlidingWindow","data","size","_index","functor","apply","arguments","windowData","accumulatorIdx","undef","result","forEach","d","i","mapped","push","shift","pop","x","length","_noop","require","_identity"],"sources":["C:\\Users\\gabby\\trax-x\\node_modules\\src\\lib\\utils\\mappedSlidingWindow.js"],"sourcesContent":["\n\nimport noop from \"./noop\";\nimport identity from \"./identity\";\nimport { functor } from \"./index\";\n\nexport default function() {\n\n\tlet undefinedValue = undefined,\n\t\twindowSize = 10,\n\t\taccumulator = noop,\n\t\tsource = identity,\n\t\tskipInitial = 0;\n\n\t// eslint-disable-next-line prefer-const\n\tlet mappedSlidingWindow = function(data) {\n\t\tconst size = functor(windowSize).apply(this, arguments);\n\t\tconst windowData = [];\n\t\tlet accumulatorIdx = 0;\n\t\tconst undef = functor(undefinedValue);\n\t\t// console.log(skipInitial, size, data.length, windowData.length);\n\t\tconst result = [];\n\t\tdata.forEach(function(d, i) {\n\t\t\t// console.log(d, i, windowData.length);\n\t\t\tlet mapped;\n\t\t\tif (i < (skipInitial + size - 1)) {\n\t\t\t\tmapped = undef(d, i);\n\t\t\t\tresult.push(mapped);\n\t\t\t\twindowData.push(mapped);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (i >= (skipInitial + size)) {\n\t\t\t\t// Treat windowData as FIFO rolling buffer\n\t\t\t\twindowData.shift();\n\t\t\t}\n\t\t\twindowData.push(source(d, i));\n\t\t\tmapped = accumulator(windowData, i, accumulatorIdx++);\n\t\t\tresult.push(mapped);\n\t\t\twindowData.pop();\n\t\t\twindowData.push(mapped);\n\t\t\treturn;\n\t\t});\n\t\treturn result;\n\t};\n\n\tmappedSlidingWindow.undefinedValue = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn undefinedValue;\n\t\t}\n\t\tundefinedValue = x;\n\t\treturn mappedSlidingWindow;\n\t};\n\tmappedSlidingWindow.windowSize = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn windowSize;\n\t\t}\n\t\twindowSize = x;\n\t\treturn mappedSlidingWindow;\n\t};\n\tmappedSlidingWindow.accumulator = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn accumulator;\n\t\t}\n\t\taccumulator = x;\n\t\treturn mappedSlidingWindow;\n\t};\n\tmappedSlidingWindow.skipInitial = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn skipInitial;\n\t\t}\n\t\tskipInitial = x;\n\t\treturn mappedSlidingWindow;\n\t};\n\tmappedSlidingWindow.source = function(x) {\n\t\tif (!arguments.length) {\n\t\t\treturn source;\n\t\t}\n\t\tsource = x;\n\t\treturn mappedSlidingWindow;\n\t};\n\n\treturn mappedSlidingWindow;\n}"],"mappings":";;;;;kBAMe,YAAW;EAEzB,IAAIA,cAAA,GAAiBC,SAArB;IACCC,UAAA,GAAa,EADd;IAECC,WAAA,GAAAC,MAAA,CAAAC,OAFD;IAGCC,MAAA,GAAAC,UAAA,CAAAF,OAHD;IAICG,WAAA,GAAc,CAJf;;EAMA;EACA,IAAIC,mBAAA,GAAsB,SAAtBA,mBAAsBA,CAASC,IAAT,EAAe;IACxC,IAAMC,IAAA,GAAO,IAAAC,MAAA,CAAAC,OAAA,EAAQX,UAAR,EAAoBY,KAApB,CAA0B,IAA1B,EAAgCC,SAAhC,CAAb;IACA,IAAMC,UAAA,GAAa,EAAnB;IACA,IAAIC,cAAA,GAAiB,CAArB;IACA,IAAMC,KAAA,GAAQ,IAAAN,MAAA,CAAAC,OAAA,EAAQb,cAAR,CAAd;IACA;IACA,IAAMmB,MAAA,GAAS,EAAf;IACAT,IAAA,CAAKU,OAAL,CAAa,UAASC,CAAT,EAAYC,CAAZ,EAAe;MAC3B;MACA,IAAIC,MAAA,SAAJ;MACA,IAAID,CAAA,GAAKd,WAAA,GAAcG,IAAd,GAAqB,CAA9B,EAAkC;QACjCY,MAAA,GAASL,KAAA,CAAMG,CAAN,EAASC,CAAT,CAAT;QACAH,MAAA,CAAOK,IAAP,CAAYD,MAAZ;QACAP,UAAA,CAAWQ,IAAX,CAAgBD,MAAhB;QACA;MACA;MACD,IAAID,CAAA,IAAMd,WAAA,GAAcG,IAAxB,EAA+B;QAC9B;QACAK,UAAA,CAAWS,KAAX;MACA;MACDT,UAAA,CAAWQ,IAAX,CAAgBlB,MAAA,CAAOe,CAAP,EAAUC,CAAV,CAAhB;MACAC,MAAA,GAASpB,WAAA,CAAYa,UAAZ,EAAwBM,CAAxB,EAA2BL,cAAA,EAA3B,CAAT;MACAE,MAAA,CAAOK,IAAP,CAAYD,MAAZ;MACAP,UAAA,CAAWU,GAAX;MACAV,UAAA,CAAWQ,IAAX,CAAgBD,MAAhB;MACA;IACA,CAnBD;IAoBA,OAAOJ,MAAP;EACA,CA5BD;EA8BAV,mBAAA,CAAoBT,cAApB,GAAqC,UAAS2B,CAAT,EAAY;IAChD,IAAI,CAACZ,SAAA,CAAUa,MAAf,EAAuB;MACtB,OAAO5B,cAAP;IACA;IACDA,cAAA,GAAiB2B,CAAjB;IACA,OAAOlB,mBAAP;EACA,CAND;EAOAA,mBAAA,CAAoBP,UAApB,GAAiC,UAASyB,CAAT,EAAY;IAC5C,IAAI,CAACZ,SAAA,CAAUa,MAAf,EAAuB;MACtB,OAAO1B,UAAP;IACA;IACDA,UAAA,GAAayB,CAAb;IACA,OAAOlB,mBAAP;EACA,CAND;EAOAA,mBAAA,CAAoBN,WAApB,GAAkC,UAASwB,CAAT,EAAY;IAC7C,IAAI,CAACZ,SAAA,CAAUa,MAAf,EAAuB;MACtB,OAAOzB,WAAP;IACA;IACDA,WAAA,GAAcwB,CAAd;IACA,OAAOlB,mBAAP;EACA,CAND;EAOAA,mBAAA,CAAoBD,WAApB,GAAkC,UAASmB,CAAT,EAAY;IAC7C,IAAI,CAACZ,SAAA,CAAUa,MAAf,EAAuB;MACtB,OAAOpB,WAAP;IACA;IACDA,WAAA,GAAcmB,CAAd;IACA,OAAOlB,mBAAP;EACA,CAND;EAOAA,mBAAA,CAAoBH,MAApB,GAA6B,UAASqB,CAAT,EAAY;IACxC,IAAI,CAACZ,SAAA,CAAUa,MAAf,EAAuB;MACtB,OAAOtB,MAAP;IACA;IACDA,MAAA,GAASqB,CAAT;IACA,OAAOlB,mBAAP;EACA,CAND;EAQA,OAAOA,mBAAP;AACA,C;AAhFD,IAAAoB,KAAA,GAAAC,OAAA;;AACA,IAAAC,SAAA,GAAAD,OAAA;;AACA,IAAAlB,MAAA,GAAAkB,OAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}